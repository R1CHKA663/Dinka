# EASY MONEY Casino - Load Testing Report

## Дата: 2026-02-07

## Результаты тестирования

### Тест 1: Умеренная нагрузка (в пределах rate limits)
- **Пользователей**: 5
- **RPS**: 10 (2 на пользователя)
- **Продолжительность**: 30 сек
- **Результат**: ✅ **100% успешных запросов**

| Метрика | Значение |
|---------|----------|
| Среднее время ответа | 17 ms |
| P50 | 13 ms |
| P95 | 36 ms |
| P99 | 55 ms |
| Фактический RPS | 9.8 |

### Тест 2: Высокая нагрузка (50 пользователей)
- **Пользователей**: 50
- **Ожидаемый RPS**: 250
- **Фактический RPS**: 154
- **Результат**: ⚠️ Ограничено rate limiting

| Метрика | Значение |
|---------|----------|
| Успешных запросов | 24.5% |
| Среднее время ответа | 43 ms |
| P95 | 193 ms |
| P99 | 722 ms |

**Причина отказов**: HTTP 429 (Rate Limiting) - все тестовые запросы идут с одного IP

## Выводы

### Положительное
1. ✅ **Backend работает стабильно** - при отсутствии rate limiting время ответа отличное (<50ms)
2. ✅ **Игровые эндпоинты быстрые** - Dice, Bubbles, X100 отвечают за 15-30ms
3. ✅ **База данных выдерживает нагрузку** - MongoDB справляется с запросами

### Рекомендации

1. **Текущие rate limits достаточны для реальных пользователей**
   - 300 игр/минуту на IP = ~5 игр/сек (реальный игрок делает ~1 игру/5 сек)
   - При real-world трафике каждый пользователь имеет свой IP

2. **Для масштабирования под высокую нагрузку рекомендуется:**
   - Использовать Redis для rate limiting (вместо in-memory)
   - Добавить кэширование для статических данных
   - Вынести БД операции в очереди (для выплат, бонусов)

3. **Узкие места:**
   - `/history/recent` - 141ms avg (индексирование?)
   - `/auth/demo` - 220ms avg (создание пользователя)

## Настройки Rate Limits (текущие для продакшена)

```python
RATE_LIMITS = {
    "default": 500,    # 500 запросов/мин на IP
    "auth": 30,        # 30 авторизаций/мин
    "games": 300,      # 300 игр/мин
    "admin": 100,      # 100 админ-запросов/мин
    "payment": 30,     # 30 платежей/мин
}
```

## Файлы
- Скрипт тестирования: `/app/backend/load_test.py`
- Использование: `python3 load_test.py --users 10 --duration 60 --rps 2`
